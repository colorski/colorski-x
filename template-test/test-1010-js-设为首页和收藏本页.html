<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="renderer" content="webkit" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1"/>
<link rel="shortcut icon" href="images/favicon.ico"/>
<link rel="bookmark" href="images/favicon.ico"/>

<title>test-1010-js-设为首页和收藏本页</title>
<meta name="keywords" content="" />
<meta name="description" content="" />

<link rel="stylesheet" href="css/reset.css" />

<link type="text/css" rel="stylesheet" href="http://www.colorski.com/plugins/codeView/shCore.css"/>
<script type="text/javascript" src="http://www.colorski.com/plugins/codeView/shCore.js"></script>
<script type="text/javascript" src="http://www.colorski.com/plugins/codeView/shBrushJScript.js"></script>
<script type="text/javascript" src="http://www.colorski.com/plugins/codeView/shBrushCss.js"></script>
<script type="text/javascript" src="http://www.colorski.com/plugins/codeView/shBrushXml.js"></script>
</head>

<body>
<!--header-->
<header>
    <h1><a href="../x.html" class="fl spec-a" title="返回">《</a>设为首页和收藏本页</h1>
</header>

<!--colorBorder-->
<div class="topclor"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"></p>
</div>
<p>注意以下方法需要再次测试!</p>
<section>
    <h5>设为首页</h5>
    <pre  class="brush:javascript;">
function SetHome(obj,url){
    try{
        obj.style.behavior='url(#default#homepage)';
        obj.setHomePage(url);
    }catch(e){
        if(window.netscape){
            try{
                netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
            }catch(e){
                alert("抱歉，此操作被浏览器拒绝！\n\n请在浏览器地址栏输入“about:config”并回车然后将[signed.applets.codebase_principal_support]设置为'true'");
            }
        }else{
            alert("抱歉，您所使用的浏览器无法完成此操作。\n\n您需要手动将【"+url+"】设置为首页。");
        }
    }
};
页面调用:
<a href="javascript:void(0);" onclick="SetHome(this,'http://www.colorski.com');">设为首页</a>
	</pre>
    <h5>收藏本站</h5>
    <pre  class="brush:javascript;">
function AddFavorite(title, url) {
    try {
        window.external.addFavorite(url, title);
    }
    catch (e) {
        try {
            window.sidebar.addPanel(title, url, "");
        }
        catch (e) {
            alert("抱歉，您所使用的浏览器无法完成此操作。\n\n加入收藏失败，请使用Ctrl+D进行添加");
        }
    }
};
页面调用:
<a href="javascript:void(0);" onclick="AddFavorite('我的网站',location.href)">收藏本站</a>
	</pre>
    <h5>加入收藏</h5>
    <pre  class="brush:javascript;">
    加入收藏：  同时兼容IE6、IE7、Firefox、Opera等浏览器。
	<a href="http://www.ks5u.com/" onclick="window.external.addFavorite(this.href,this.title);return false;" title='高考资源网' rel="sidebar">加入收藏</a>
    </pre>
</section>

<!--colorBorder-->
<div class="topclor mar-top"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"></p>
</div>

<!--footer-->
<footer>
    <a href="../../index.html" class="fr footer-a" title="www.colorski.com/">www.colorski.com/</a>
</footer>
</body>
</html>
