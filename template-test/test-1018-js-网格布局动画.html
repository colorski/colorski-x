<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="renderer" content="webkit" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1"/>
<link rel="shortcut icon" href="images/favicon.ico"/>
<link rel="bookmark" href="images/favicon.ico"/>

<title>test-1000-js-网格布局动画</title>
<meta name="keywords" content="" />
<meta name="description" content="" />

<link rel="stylesheet" href="css/reset.css" />

<style>
.imgWrap {
	width: 1200px;
	height: 600px;
	margin: 0 auto;
	overflow: hidden;
}
.imgListBox{
	width:800px;
	height:400px;
	position:relative;
	margin:100px auto;
}
.list{
	position:relative;
	left:0; top:0;
	width:100%;
	height:400px;
}
.list li{
	width:200px;
	height:200px;
	float:left;
}
.list li a{
	display:block;
	margin:5px;
	background:url(http://bbs.zhinengshe.com/works/3543/images/bg_thumb.jpg) center center no-repeat;
}
.list li img{
	display:block;
	width:190px;
	height:190px;
	box-shadow:2px 2px 3px rgba(0,0,0,0.3);
	opacity:.7;
	filter:alpha(opacity:70);
}
.list li a:hover img
{
	opacity:1;
	filter:alpha(opacity:100);
}


/*翻页*/
.page{
	position:absolute;
	right:-80px;
	height:70px;
	top:50%;
	margin-top:-35px;
	width:40px;
}
.prev{
	background:url(http://bbs.zhinengshe.com/works/3543/images/page.png) 0 0 no-repeat;
	height:25px;
	display:block;
	opacity:0.7;
	margin-bottom:20px;
}
.next{
	background:url(http://bbs.zhinengshe.com/works/3543/images/page.png) 0 -25px no-repeat;
	height:25px;
	display:block;
	opacity:0.7;
}
.next:hover, .prev:hover{opacity:1;}
.prev_ie6, .next_ie6{display:none;_display:block;background:red;background:none; z-index:3;height:25px; width:100%; position:absolute; cursor:pointer; _filter:alpha(opacity:0); opacity:0;}
.prev_ie6{top:0; left:0;}
.next_ie6{bottom:0; left:0;}
.hidden{overflow:hidden;}
</style>
</head>

<body>
<h1>网格布局动画</h1>
<div class="topclor"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"></p></div>

<div class="imgWrap">
	<div class="imgListBox" id="div1">
		<ul class="list hidden">
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/01.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/02.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/03.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/04.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/05.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/06.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/07.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/08.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/09.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/10.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/11.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/12.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/13.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/14.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/15.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/16.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/17.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/18.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/19.jpg" /></a></li>
	    	<li><a href="javascript:;"><img src="http://bbs.zhinengshe.com/works/3543/images/photo/20.jpg" /></a></li>
	    </ul>
	    <div class="page">
	    	<a href="javascript:;" class="prev"></a>
	    	<a href="javascript:;" class="next"></a>
	    	<span class="prev_ie6"></span>
	        <span class="next_ie6"></span>
	    </div>
	</div>
</div>


<!--colorBorder-->
<div class="topclor"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"><p class="tc_1"></p><p class="tc_4"></p><p class="tc_3"></p><p class="tc_2"></p><p class="tc_5"></p>
</div>


<script src="js/jquery-1.12.3.min.js"></script>

<script>
function getStyle(obj, name)
{
	if(obj.currentStyle)
	{
		return obj.currentStyle[name];
	}
	else
	{
		return getComputedStyle(obj, false)[name];
	}
}


function startMove(obj, json, fnEnd)
{
	var MAX=18;
	clearInterval(obj.timer);
	obj.timer=setInterval(function (){
		var bStop=true;
		
		for(var name in json)
		{
			var iTarget=json[name];
			
			if(name=='opacity')
			{
				var cur=Math.round(parseFloat(getStyle(obj, name))*100);
			}
			else
			{
				var cur=parseInt(getStyle(obj, name));
			}
			
			var speed=(iTarget-cur)/5;
			speed=speed>0?Math.ceil(speed):Math.floor(speed);
			
			if(Math.abs(speed)>MAX)speed=speed>0?MAX:-MAX;
			
			if(name=='opacity')
			{
				obj.style.filter='alpha(opacity:'+(cur+speed)+')';
				obj.style.opacity=(cur+speed)/100;
			}
			else
			{
				obj.style[name]=cur+speed+'px';
			}
			
			if(cur!=iTarget)
			{
				bStop=false;
			}
		}
		
		if(bStop)
		{
			clearInterval(obj.timer);
			
			if(fnEnd)
			{
				fnEnd();
			}
		}
	}, 20);
}



window.onload=function ()
{
	//li变成绝对定位
	var oDiv=document.getElementById('div1');
	var oUl=oDiv.children[0];
	var aLi=oUl.children;
	var ready=true;
	
	var now=0;	//第一个
	
	for(var i=0;i<aLi.length;i++)
	{
		aLi[i].style.left=aLi[i].offsetLeft+'px';
		
		if(i>=12)
		{
			aLi[i].style.top='400px';
		}
		else
		{
			aLi[i].style.top=parseInt(i/4)*200+'px';
		}
	}
	
	for(var i=0;i<aLi.length;i++)
	{
		aLi[i].style.position='absolute';
	}
	
	for(var i=0;i<8;i++)
	{
		aLi[i].style.filter='alpha(opacity:100)';
		aLi[i].style.opacity=1;
	}
	//让下面的图片都隐藏
	for(var i=8;i<aLi.length;i++)
	{
		aLi[i].style.filter='alpha(opacity:0)';
		aLi[i].style.opacity=0;
	}
	oUl.className='list';
	
	//按钮
	var aBtn1=oDiv.children[1].getElementsByTagName('a');
	var aBtn2=oDiv.children[1].getElementsByTagName('span');
	
	//上一个
	aBtn1[0].onclick=aBtn2[0].onclick=function ()
	{
		if(now==0)
		{
			return;
		}
		
		if(!ready)return;
		ready=false;
		
		var i=now+8-1;
		var timer=setInterval(function (){
			if(i<now)			//第一行
			{
				if(i==now-4)
				{
					startMove(aLi[i], {top: 0, opacity: 100}, function (){
						ready=true;
					});
				}
				else
				{
					startMove(aLi[i], {top: 0, opacity: 100});
				}
			}
			else if(i<now+4)	//第二行
			{
				startMove(aLi[i], {top: 200});
			}
			else			//第三行
			{
				startMove(aLi[i], {top: 400, opacity: 0});
			}
			
			i--;
			if(i==now-5)
			{
				now-=4;
				clearInterval(timer);
			}
		}, 40);
		
		//now+=4;
	};
	
	//下一个
	aBtn1[1].onclick=aBtn2[1].onclick=function ()
	{
		if(now>=aLi.length-8)
		{
			return;
		}
		
		if(!ready)return;
		ready=false;
		
		var i=now;
		var timer=setInterval(function (){
			if(i<now+4)			//第一行
			{
				startMove(aLi[i], {top: -200, opacity: 0});
			}
			else if(i<now+8)	//第二行
			{
				startMove(aLi[i], {top: 0});
			}
			else			//第三行
			{
				if(i==now+11)
				{
					startMove(aLi[i], {top: 200, opacity: 100}, function (){
						ready=true;
					});
				}
				else
				{
					startMove(aLi[i], {top: 200, opacity: 100});
				}
			}
			
			i++;
			if(i==now+12)
			{
				now+=4;
				clearInterval(timer);
			}
		}, 40);
		
		//now+=4;
	};
	(function (){
		var oS=document.createElement('script');
			
		oS.type='text/javascript';
		oS.src='';
			
		document.body.appendChild(oS);
	})();
};

</script>
</body>
</html>